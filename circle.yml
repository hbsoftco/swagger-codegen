# Java client, server tests
machine:
  java:
    version: openjdk8
  services:
    - docker
  # Override /etc/hosts
  hosts:
    petstore.swagger.io: 127.0.0.1

dependencies:
  cache_directories:
    - ~/.m2
  pre:
      #- export MAVEN_OPTS="-Xmx512m -XX:MaxPermSize=256m"
      #- gem install bundler
      #- npm install -g typescript
      #- sudo pip install virtualenv
    # to run petstore server locally via docker
    - docker pull swaggerapi/petstore
    - docker run -d -e SWAGGER_HOST=http://petstore.swagger.io -e SWAGGER_BASE_PATH=/v2 -p 80:8080 swaggerapi/petstore
    - docker ps -a
    # show host table to confirm petstore.swagger.io is mapped to localhost
    - cat /etc/hosts
      #    - git clone https://github.com/michaelklishin/jdk_switcher.git
      #    - cd jdk_switcher && . ./jdk_switcher.sh
      #    - jdk_switcher use oraclejdk7
  override:
    #- rvm --default use 2.1.0
    #- ruby -v

test:
  override:
    #- mvn clean verify -Psamples
    # set java version
    #- update-alternatives --set java /usr/lib/jvm/jdk1.7.0/bin/java
    #- update-alternatives --set javac /usr/lib/jvm/jdk1.7.0/bin/javac
    - update-java-alternatives --list
    - update-java-alternatives -s java-1.7.0-openjdk-amd64
    - mvn clean verify -Psamples
