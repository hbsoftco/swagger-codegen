sudo: required
language: objective-c 

cache:
  directories:
  - $HOME/.m2
  - $HOME/.rvm
  - $HOME/.cocoapods
  - samples/client/petstore/objc/default/SwaggerClientTests/Pods

services:
  - docker

addons:
  hosts:
    - petstore.swagger.io

before_install:
   - rvm list
   - rvm install 2.2.2 > /dev/null 2>&1
   - rvm use 2.2.2
   - sudo gem install cocoapods
   - pod --version
   - pod setup > /dev/null 2>&1
   - brew install xctool
   # Install Cask
   - brew install caskroom/cask/brew-cask
   # Install docker toolbox
   - brew cask install dockertoolbox
   # to run petstore server locally via docker
   - docker pull swaggerapi/petstore
   - docker run -d -e SWAGGER_HOST=http://petstore.swagger.io -e SWAGGER_BASE_PATH=/v2 -p 80:8080 swaggerapi/petstore
   - docker ps -a 

install:

script:
   - cd samples/client/petstore/objc/default/SwaggerClientTests && pod install && xctool -workspace "SwaggerClient.xcworkspace" -scheme "SwaggerClient-Example" test

env:
  - DOCKER_IMAGE_NAME=swaggerapi/swagger-generator
